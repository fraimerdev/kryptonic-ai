<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Kryptonic AI Chat</title>
    <style>
        /* Kryptonic AI - Advanced Cryptocurrency Theme Styles */

        :root {
            /* Crypto-themed color palette */
            --primary-green: #00ff88;
            --primary-blue: #00d4ff;
            --accent-pink: #ff0080;
            --bitcoin-orange: #f7931a;
            --ethereum-blue: #627eea;
            
            /* Fonts */
            --font-primary: 'Space Grotesk', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-mono: 'Orbitron', 'Courier New', monospace;
            
            /* Spacing */
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --spacing-xxl: 3rem;
        }

        /* Dark Theme (Default) */
        [data-theme="dark"] {
            /* Background colors */
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a24;
            --bg-card: rgba(255, 255, 255, 0.05);
            --bg-hover: rgba(0, 255, 136, 0.1);
            
            /* Text colors */
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-muted: #666666;
            
            /* Status colors */
            --success: #00ff88;
            --danger: #ff4757;
            --warning: #ffa502;
            --info: #00d4ff;
            
            /* Borders and shadows */
            --border-primary: rgba(0, 255, 136, 0.3);
            --border-secondary: rgba(255, 255, 255, 0.1);
            --shadow-primary: 0 8px 32px rgba(0, 255, 136, 0.2);
            --shadow-secondary: 0 4px 16px rgba(0, 0, 0, 0.3);
            
            /* Particles */
            --particle-opacity: 0.7;
        }

        /* Light Theme */
        [data-theme="light"] {
            /* Background colors - Dimmer warm grays */
            --bg-primary: #e8e4dc;
            --bg-secondary: #ddd8cf;
            --bg-tertiary: #d1cbc0;
            --bg-card: rgba(221, 216, 207, 0.9);
            --bg-hover: rgba(0, 255, 136, 0.08);
            
            /* Text colors - Better contrast on dimmer background */
            --text-primary: #1f1c17;
            --text-secondary: #4a453c;
            --text-muted: #706b5e;
            
            /* Status colors - Adjusted for dimmer background */
            --success: #059669;
            --danger: #b91c1c;
            --warning: #c2410c;
            --info: #0369a1;
            
            /* Borders and shadows - Adjusted for dimmer theme */
            --border-primary: rgba(0, 255, 136, 0.4);
            --border-secondary: rgba(31, 28, 23, 0.15);
            --shadow-primary: 0 8px 32px rgba(0, 255, 136, 0.15);
            --shadow-secondary: 0 4px 16px rgba(31, 28, 23, 0.12);
            
            /* Particles */
            --particle-opacity: 0.2;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-primary);
            background: linear-gradient(135deg, 
                var(--bg-primary) 0%, 
                var(--bg-secondary) 50%, 
                var(--bg-tertiary) 100%);
            color: var(--text-primary);
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }

        /* Animated Background Particles */
        .background-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--primary-green);
            border-radius: 50%;
            opacity: var(--particle-opacity);
            animation: float 15s infinite linear;
        }

        .particle:nth-child(even) {
            background: var(--primary-blue);
            animation-direction: reverse;
        }

        .particle:nth-child(3n) {
            background: var(--accent-pink);
            width: 1px;
            height: 1px;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) translateX(0px);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            90% {
                opacity: 0.7;
            }
            100% {
                transform: translateY(-100px) translateX(100px);
                opacity: 0;
            }
        }

        /* Navigation Header */
        .nav-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(10, 10, 15, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-secondary);
            padding: var(--spacing-md) 0;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 var(--spacing-lg);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-family: var(--font-mono);
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--primary-green);
        }

        .rotating {
            animation: rotate 3s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .nav-menu {
            display: flex;
            gap: var(--spacing-lg);
        }

        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: 8px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .nav-link:hover,
        .nav-link.active {
            color: var(--primary-green);
            background: var(--bg-hover);
        }

        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--primary-green), var(--primary-blue));
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }

        /* Theme Toggle Button */
        .theme-toggle-btn {
            width: 36px;
            height: 36px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-secondary);
            border-radius: 50%;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: var(--spacing-md);
            transition: all 0.3s ease;
            font-size: 0.875rem;
        }

        .theme-toggle-btn:hover {
            background: var(--bg-hover);
            border-color: var(--primary-green);
            color: var(--primary-green);
            transform: rotate(180deg);
        }

        [data-theme="light"] .theme-toggle-btn:hover {
            color: var(--primary-blue);
            border-color: var(--primary-blue);
        }

        /* Main Layout */
        .main-container {
            display: flex;
            min-height: 100vh;
            padding-top: 80px;
            position: relative;
            z-index: 1;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--border-secondary);
            padding: var(--spacing-lg);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .sidebar-section h3 {
            font-size: 1.125rem;
            margin-bottom: var(--spacing-md);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .sidebar-section h3 i {
            color: var(--primary-green);
        }

        /* Market Data Styles */
        .market-data,
        .trending-data {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .market-item,
        .trending-item {
            background: var(--bg-secondary);
            padding: var(--spacing-md);
            border-radius: 12px;
            border: 1px solid var(--border-secondary);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .market-item:hover,
        .trending-item:hover {
            border-color: var(--primary-green);
            transform: translateY(-2px);
            box-shadow: var(--shadow-primary);
        }

        .market-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .coin-info {
            display: flex;
            flex-direction: column;
        }

        .coin-name {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.875rem;
        }

        .coin-symbol {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        .coin-price {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .price {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.875rem;
        }

        .change {
            font-size: 0.75rem;
            font-weight: 500;
        }

        .change.positive {
            color: var(--success);
        }

        .change.negative {
            color: var(--danger);
        }

        .trending-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .rank {
            width: 24px;
            height: 24px;
            background: var(--primary-green);
            color: var(--bg-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .trending-indicator {
            margin-left: auto;
            color: var(--accent-pink);
            animation: flicker 2s infinite;
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .loading-placeholder, .error-placeholder {
            text-align: center;
            color: var(--text-muted);
            padding: var(--spacing-lg);
        }

        .error-placeholder i {
            font-size: 2rem;
            margin-bottom: var(--spacing-sm);
            opacity: 0.5;
        }

        /* Chat Main Section */
        .chat-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            max-width: calc(100vw - 280px);
        }

        .chat-header {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--border-secondary);
            display: flex;
            align-items: center;
            gap: var(--spacing-lg);
        }

        .ai-avatar {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-green), var(--primary-blue));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--bg-primary);
            animation: glow 3s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 20px rgba(0, 255, 136, 0.3); }
            to { box-shadow: 0 0 30px rgba(0, 255, 136, 0.6); }
        }

        .chat-title h1 {
            font-size: 1.5rem;
            margin-bottom: var(--spacing-xs);
            background: linear-gradient(135deg, var(--primary-green), var(--primary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .chat-title p {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .chat-controls {
            margin-left: auto;
            display: flex;
            gap: var(--spacing-sm);
        }

        .control-btn {
            width: 40px;
            height: 40px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-secondary);
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:hover {
            background: var(--bg-hover);
            color: var(--primary-green);
            border-color: var(--primary-green);
        }

        .control-btn.active {
            background: var(--primary-green);
            color: var(--bg-primary);
            border-color: var(--primary-green);
        }

        /* Voice Output Toggle Styles */
        .voice-output-toggle {
            position: relative;
        }

        .voice-output-toggle.active {
            background: var(--primary-blue);
            color: var(--bg-primary);
            border-color: var(--primary-blue);
            animation: voicePulse 2s infinite;
        }

        @keyframes voicePulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(0, 212, 255, 0.7); }
            50% { box-shadow: 0 0 0 8px rgba(0, 212, 255, 0); }
        }

        .voice-status-indicator {
            position: absolute;
            top: -4px;
            right: -4px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--success);
            border: 2px solid var(--bg-secondary);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .voice-status-indicator.active {
            opacity: 1;
            animation: pulse 2s infinite;
        }

        /* Chat Container */
        .chat-container {
            flex: 1;
            padding: var(--spacing-lg);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
            max-height: calc(100vh - 280px);
        }

        .message {
            display: flex;
            gap: var(--spacing-md);
            animation: messageSlide 0.3s ease-out;
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .user-message {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }

        .ai-message .message-avatar {
            background: linear-gradient(135deg, var(--primary-green), var(--primary-blue));
            color: var(--bg-primary);
        }

        .user-message .message-avatar {
            background: linear-gradient(135deg, var(--accent-pink), var(--primary-blue));
            color: var(--text-primary);
        }

        .message-content {
            flex: 1;
            max-width: 70%;
        }

        .message-text {
            background: var(--bg-card);
            padding: var(--spacing-md) var(--spacing-lg);
            border-radius: 18px;
            line-height: 1.6;
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-secondary);
            word-wrap: break-word;
            position: relative;
        }

        .user-message .message-text {
            background: linear-gradient(135deg, var(--primary-green), var(--primary-blue));
            color: var(--bg-primary);
            margin-left: auto;
        }

        .error-message {
            border-left: 3px solid var(--danger) !important;
            background: rgba(255, 71, 87, 0.1) !important;
        }

        .message-time {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: var(--spacing-xs);
            text-align: right;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            justify-content: flex-end;
        }

        .user-message .message-time {
            text-align: left;
            justify-content: flex-start;
        }

        /* Audio Controls */
        .audio-controls {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .audio-play-btn {
            width: 24px;
            height: 24px;
            background: var(--primary-blue);
            color: var(--bg-primary);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            transition: all 0.3s ease;
            opacity: 0.7;
        }

        .audio-play-btn:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        .audio-play-btn.playing {
            background: var(--accent-pink);
            animation: pulse 1s infinite;
        }

        .voice-indicator {
            font-size: 0.75rem;
            color: var(--primary-blue);
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .voice-wave {
            width: 3px;
            height: 10px;
            background: var(--primary-blue);
            border-radius: 2px;
            animation: wave 1s infinite;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }

        @keyframes wave {
            0%, 100% { height: 6px; opacity: 0.4; }
            50% { height: 12px; opacity: 1; }
        }

        .crypto-symbol {
            color: var(--primary-green);
            font-weight: 600;
        }

        .price-highlight {
            color: var(--primary-blue);
            font-weight: 600;
        }

        .percentage {
            font-weight: 600;
        }

        .emoji {
            font-size: 1.1em;
        }

        /* Chat Input Form */
        .chat-input-form {
            padding: var(--spacing-lg);
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--border-secondary);
        }

        .input-container {
            display: flex;
            align-items: center;
            background: var(--bg-secondary);
            border: 2px solid var(--border-secondary);
            border-radius: 25px;
            padding: var(--spacing-sm);
            transition: all 0.3s ease;
            margin-bottom: var(--spacing-md);
        }

        .input-container:focus-within {
            border-color: var(--primary-green);
            box-shadow: 0 0 0 3px rgba(0, 255, 136, 0.1);
        }

        #message-text {
            flex: 1;
            background: none;
            border: none;
            outline: none;
            color: var(--text-primary);
            font-size: 1rem;
            padding: var(--spacing-sm) var(--spacing-md);
            font-family: inherit;
            min-height: 20px;
            resize: none;
        }

        #message-text::placeholder {
            color: var(--text-muted);
        }

        .input-actions {
            display: flex;
            gap: var(--spacing-sm);
        }

        .voice-btn,
        .send-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .voice-btn {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
        }

        .voice-btn:hover {
            background: var(--primary-blue);
            color: var(--text-primary);
            transform: scale(1.1);
        }

        .voice-btn.recording {
            background: var(--danger);
            color: var(--text-primary);
            animation: pulse 1s infinite;
        }

        .send-btn {
            background: linear-gradient(135deg, var(--primary-green), var(--primary-blue));
            color: var(--bg-primary);
        }

        .send-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.4);
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
        }

        .quick-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border-secondary);
            border-radius: 20px;
            padding: var(--spacing-sm) var(--spacing-md);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: 0.875rem;
            white-space: nowrap;
        }

        .quick-btn:hover {
            background: var(--bg-hover);
            color: var(--primary-green);
            border-color: var(--primary-green);
            transform: translateY(-2px);
        }

        /* Loading States */
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-secondary);
            border-top: 3px solid var(--primary-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto var(--spacing-md);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            color: var(--text-muted);
            font-style: italic;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dots span {
            width: 6px;
            height: 6px;
            background: var(--primary-green);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
        .typing-dots span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.3;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: 16px;
            padding: var(--spacing-xxl);
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .toast {
            position: fixed;
            top: 100px;
            right: 20px;
            padding: 12px 24px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 9999;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }

        .toast-info { background: var(--primary-blue); }
        .toast-success { background: var(--success); }
        .toast-error { background: var(--danger); }
        .toast-warning { background: var(--warning); }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-green);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-blue);
        }

        /* Animation classes for market items */
        .market-item, .trending-item {
            animation: slideInUp 0.3s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes slideInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .sidebar {
                width: 250px;
            }
            
            .nav-container {
                padding: 0 var(--spacing-md);
            }

            .chat-main {
                max-width: calc(100vw - 250px);
            }
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                max-height: 200px;
                overflow-y: auto;
            }
            
            .chat-main {
                max-width: 100%;
            }
            
            .nav-menu {
                display: none;
            }
            
            .message-content {
                max-width: 85%;
            }
            
            .quick-actions {
                justify-content: center;
            }
            
            .chat-container {
                max-height: calc(100vh - 400px);
            }
        }

        @media (max-width: 480px) {
            .nav-container {
                padding: 0 var(--spacing-sm);
            }
            
            .logo {
                font-size: 1.25rem;
            }
            
            .chat-header {
                padding: var(--spacing-md);
            }
            
            .ai-avatar {
                width: 50px;
                height: 50px;
                font-size: 1.25rem;
            }
            
            .chat-title h1 {
                font-size: 1.25rem;
            }
            
            .message-content {
                max-width: 90%;
            }
            
            .quick-btn {
                font-size: 0.75rem;
                padding: var(--spacing-xs) var(--spacing-sm);
            }
        }
    </style>
</head>
<body>
    <!-- Animated background particles -->
    <div class="background-particles"></div>
    
    <!-- Navigation Header -->
    <header class="nav-header">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-cube rotating"></i>
                <span class="logo-text">Kryptonic AI</span>
            </div>
            <nav class="nav-menu">
                <span class="nav-link active">Chat</span>
                <span class="nav-link" onclick="showMarketOverview()">Market</span>
                <span class="nav-link" onclick="showTrending()">Trending</span>
            </nav>
            <div class="status-indicator">
                <div class="status-dot"></div>
                <span>Demo Mode</span>
                <button class="theme-toggle-btn" onclick="toggleTheme()" id="theme-toggle" title="Toggle Light/Dark Mode">
                    <i class="fas fa-sun" id="theme-icon"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar with Market Data -->
        <aside class="sidebar">
            <div class="sidebar-section">
                <h3><i class="fas fa-chart-line"></i> Market Overview</h3>
                <div id="market-data" class="market-data">
                    <div class="loading-placeholder">Loading market data...</div>
                </div>
            </div>
            
            <div class="sidebar-section">
                <h3><i class="fas fa-fire"></i> Trending Now</h3>
                <div id="trending-data" class="trending-data">
                    <div class="loading-placeholder">Loading trending coins...</div>
                </div>
            </div>
        </aside>

        <!-- Chat Container -->
        <main class="chat-main">
            <div class="chat-header">
                <div class="ai-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="chat-title">
                    <h1>Kryptonic AI Assistant</h1>
                    <p>Your intelligent cryptocurrency companion</p>
                </div>
                <div class="chat-controls">
                    <button class="control-btn" onclick="clearChat()" title="Clear Chat">
                        <i class="fas fa-trash"></i>
                    </button>
                    <button class="control-btn voice-output-toggle" onclick="toggleVoiceOutput()" title="Toggle Voice Output" id="voice-output-btn">
                        <i class="fas fa-volume-up"></i>
                        <div class="voice-status-indicator" id="voice-status-indicator"></div>
                    </button>
                    <button class="control-btn" onclick="toggleVoiceInput()" title="Voice Input">
                        <i class="fas fa-microphone"></i>
                    </button>
                </div>
            </div>

            <div class="chat-container" id="chat-box">
                <div class="message ai-message">
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content">
                        <div class="message-text">
                            Hey there! I'm Kryptonic AI, your crypto companion. Whether you need real-time prices, market insights, or want to learn about blockchain tech, I'm here to help. Try asking me about Bitcoin prices or trending cryptocurrencies to get started!
                        </div>
                        <div class="message-time">Just now</div>
                    </div>
                </div>
            </div>

            <form class="chat-input-form" id="chat-form">
                <div class="input-container">
                    <input type="text" id="message-text" placeholder="Ask me about cryptocurrencies..." autocomplete="off">
                    <div class="input-actions">
                        <button type="button" class="voice-btn" id="voice-btn">
                            <i class="fas fa-microphone"></i>
                        </button>
                        <button type="submit" class="send-btn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
                <div class="quick-actions">
                    <button type="button" class="quick-btn" onclick="sendQuickMessage('What is the price of Bitcoin?')">
                        <i class="fab fa-bitcoin"></i> BTC Price
                    </button>
                    <button type="button" class="quick-btn" onclick="sendQuickMessage('Show me trending cryptocurrencies')">
                        <i class="fas fa-fire"></i> Trending
                    </button>
                    <button type="button" class="quick-btn" onclick="sendQuickMessage('Market overview')">
                        <i class="fas fa-chart-bar"></i> Market
                    </button>
                    <button type="button" class="quick-btn" onclick="sendQuickMessage('Explain blockchain technology')">
                        <i class="fas fa-cube"></i> Blockchain
                    </button>
                </div>
            </form>
        </main>
    </div>

    <!-- Loading Modal -->
    <div id="loading-modal" class="modal">
        <div class="modal-content">
            <div class="loading-spinner"></div>
            <p>Processing your request...</p>
        </div>
    </div>

    <script>
        // Kryptonic AI - Enhanced JavaScript with Voice Output Integration

        class KryptonicAI {
            constructor() {
                this.isRecording = false;
                this.voiceOutputEnabled = false;
                this.recognition = null;
                this.synthesis = window.speechSynthesis;
                this.currentAudio = null;
                this.chatBox = document.getElementById('chat-box');
                this.messageInput = document.getElementById('message-text');
                this.chatForm = document.getElementById('chat-form');
                this.voiceBtn = document.getElementById('voice-btn');
                this.voiceOutputBtn = document.getElementById('voice-output-btn');
                this.voiceStatusIndicator = document.getElementById('voice-status-indicator');
                this.loadingModal = document.getElementById('loading-modal');
                this.sessionId = this.generateSessionId();
                
                this.initializeEventListeners();
                this.initializeSpeechRecognition();
                this.displayWelcomeMessage();
                this.loadVoiceSettings();
                this.initializeTheme(); // Initialize theme on startup
            }

            initializeEventListeners() {
                // Chat form submission
                this.chatForm.addEventListener('submit', (e) => this.handleSubmit(e));
                
                // Voice input button functionality
                this.voiceBtn.addEventListener('click', () => this.toggleVoiceRecognition());
                
                // Enter key handling
                this.messageInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.handleSubmit(e);
                    }
                });

                // Auto-resize input
                this.messageInput.addEventListener('input', () => this.autoResizeInput());
                
                // Focus input on page load
                window.addEventListener('load', () => {
                    this.messageInput.focus();
                });

                // Stop audio when page unloads
                window.addEventListener('beforeunload', () => {
                    this.stopCurrentAudio();
                });
            }

            initializeSpeechRecognition() {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    this.recognition = new SpeechRecognition();
                    
                    this.recognition.continuous = false;
                    this.recognition.interimResults = false;
                    this.recognition.lang = 'en-US';
                    
                    this.recognition.onstart = () => {
                        this.isRecording = true;
                        this.voiceBtn.classList.add('recording');
                        this.voiceBtn.innerHTML = '<i class="fas fa-stop"></i>';
                        this.showToast('Listening...', 'info');
                    };
                    
                    this.recognition.onresult = (event) => {
                        const transcript = event.results[0][0].transcript;
                        this.messageInput.value = transcript;
                        this.messageInput.focus();
                        this.showToast('Speech captured!', 'success');
                    };
                    
                    this.recognition.onerror = (event) => {
                        this.showToast('Speech recognition error: ' + event.error, 'error');
                        this.stopRecording();
                    };
                    
                    this.recognition.onend = () => {
                        this.stopRecording();
                    };
                } else {
                    // Hide voice button if not supported
                    this.voiceBtn.style.display = 'none';
                }
            }

            loadVoiceSettings() {
                // Load voice output preference from localStorage
                const savedVoiceState = localStorage.getItem('kryptonic-voice-output');
                if (savedVoiceState === 'true') {
                    this.enableVoiceOutput();
                }
            }

            saveVoiceSettings() {
                localStorage.setItem('kryptonic-voice-output', this.voiceOutputEnabled.toString());
            }

            toggleVoiceOutput() {
                if (this.voiceOutputEnabled) {
                    this.disableVoiceOutput();
                } else {
                    this.enableVoiceOutput();
                }
                this.saveVoiceSettings();
            }

            enableVoiceOutput() {
                this.voiceOutputEnabled = true;
                this.voiceOutputBtn.classList.add('active');
                this.voiceStatusIndicator.classList.add('active');
                this.showToast('Voice output enabled', 'success');
            }

            disableVoiceOutput() {
                this.voiceOutputEnabled = false;
                this.voiceOutputBtn.classList.remove('active');
                this.voiceStatusIndicator.classList.remove('active');
                this.stopCurrentAudio();
                this.showToast('Voice output disabled', 'info');
            }

            toggleVoiceRecognition() {
                if (this.isRecording) {
                    this.recognition.stop();
                } else {
                    this.recognition.start();
                }
            }

            stopRecording() {
                this.isRecording = false;
                this.voiceBtn.classList.remove('recording');
                this.voiceBtn.innerHTML = '<i class="fas fa-microphone"></i>';
            }

            async handleSubmit(event) {
                event.preventDefault();
                const userMessage = this.messageInput.value.trim();
                
                if (!userMessage) return;

                // Add user message to chat
                this.addMessage(userMessage, 'user');
                this.messageInput.value = '';
                
                // Show typing indicator
                this.showTypingIndicator();
                
                // Send message to backend API
                try {
                    const response = await this.sendMessageToAPI(userMessage);
                    this.removeTypingIndicator();
                    this.addMessage(response.text, 'ai', false, response.audio);
                } catch (error) {
                    console.error('Error generating response:', error);
                    this.removeTypingIndicator();
                    this.addMessage("I'm having trouble processing your request right now. Please try again in a moment.", 'ai', true);
                }

                // Scroll to bottom and focus input
                this.scrollToBottom();
                this.messageInput.focus();
            }

            generateSessionId() {
                // Generate a unique session ID for this chat session
                return 'session_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
            }

            async sendMessageToAPI(message) {
                try {
                    const response = await fetch('/chat', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            query: message,
                            session_id: this.sessionId,
                            include_voice: this.voiceOutputEnabled
                        })
                    });

                    if (!response.ok) {
                        if (response.status === 500) {
                            throw new Error('Server error. Please check if the backend is running and properly configured.');
                        } else if (response.status === 404) {
                            throw new Error('Chat endpoint not found. Please check the backend configuration.');
                        } else {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                    }

                    const data = await response.json();
                    
                    if (!data.output) {
                        throw new Error('Invalid response format from server.');
                    }
                    
                    return {
                        text: data.output,
                        audio: data.audio || null
                    };
                } catch (error) {
                    console.error('API call failed:', error);
                    
                    // Provide more specific error messages
                    if (error.name === 'TypeError' && error.message.includes('fetch')) {
                        throw new Error('Unable to connect to the server. Please check if the backend is running.');
                    }
                    
                    throw error;
                }
            }

            addMessage(content, type, isError = false, audioData = null) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${type}-message`;
                
                const currentTime = new Date().toLocaleTimeString([], { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });

                const avatarIcon = type === 'ai' ? 
                    '<i class="fas fa-robot"></i>' : 
                    '<i class="fas fa-user"></i>';

                // Create audio controls if voice data is available
                let audioControls = '';
                if (audioData && type === 'ai' && this.voiceOutputEnabled) {
                    const audioId = 'audio-' + Date.now();
                    audioControls = `
                        <div class="audio-controls">
                            <button class="audio-play-btn" onclick="window.kryptonicApp.playAudio('${audioData}', this)" title="Play Audio">
                                <i class="fas fa-play"></i>
                            </button>
                            <div class="voice-indicator">
                                <i class="fas fa-volume-up"></i>
                                <div class="voice-wave"></div>
                                <div class="voice-wave"></div>
                                <div class="voice-wave"></div>
                                <div class="voice-wave"></div>
                            </div>
                        </div>
                    `;
                }

                messageDiv.innerHTML = `
                    <div class="message-avatar">
                        ${avatarIcon}
                    </div>
                    <div class="message-content">
                        <div class="message-text ${isError ? 'error-message' : ''}">
                            ${this.formatMessage(content)}
                        </div>
                        <div class="message-time">
                            <span>${currentTime}</span>
                            ${audioControls}
                        </div>
                    </div>
                `;

                this.chatBox.appendChild(messageDiv);
                this.scrollToBottom();

                // Auto-play audio if voice output is enabled and it's an AI message
                if (audioData && type === 'ai' && this.voiceOutputEnabled) {
                    setTimeout(() => {
                        const playBtn = messageDiv.querySelector('.audio-play-btn');
                        if (playBtn) {
                            this.playAudio(audioData, playBtn, true);
                        }
                    }, 500);
                }
            }

            async playAudio(audioData, buttonElement, autoPlay = false) {
                try {
                    // Stop any currently playing audio
                    this.stopCurrentAudio();
                    
                    // Create audio from base64 data
                    const audioBlob = this.base64ToBlob(audioData, 'audio/mp3');
                    const audioUrl = URL.createObjectURL(audioBlob);
                    
                    this.currentAudio = new Audio(audioUrl);
                    
                    // Update button state
                    buttonElement.classList.add('playing');
                    buttonElement.innerHTML = '<i class="fas fa-pause"></i>';
                    
                    // Handle audio events
                    this.currentAudio.onplay = () => {
                        if (!autoPlay) {
                            this.showToast('Playing audio...', 'info');
                        }
                    };
                    
                    this.currentAudio.onended = () => {
                        buttonElement.classList.remove('playing');
                        buttonElement.innerHTML = '<i class="fas fa-play"></i>';
                        URL.revokeObjectURL(audioUrl);
                        this.currentAudio = null;
                    };
                    
                    this.currentAudio.onerror = (error) => {
                        console.error('Audio playback error:', error);
                        buttonElement.classList.remove('playing');
                        buttonElement.innerHTML = '<i class="fas fa-play"></i>';
                        URL.revokeObjectURL(audioUrl);
                        this.currentAudio = null;
                        if (!autoPlay) {
                            this.showToast('Audio playback failed', 'error');
                        }
                    };
                    
                    // Play the audio
                    await this.currentAudio.play();
                    
                } catch (error) {
                    console.error('Error playing audio:', error);
                    buttonElement.classList.remove('playing');
                    buttonElement.innerHTML = '<i class="fas fa-play"></i>';
                    if (!autoPlay) {
                        this.showToast('Audio playback failed', 'error');
                    }
                }
            }

            stopCurrentAudio() {
                if (this.currentAudio) {
                    this.currentAudio.pause();
                    this.currentAudio.currentTime = 0;
                    this.currentAudio = null;
                    
                    // Reset all play buttons
                    const playButtons = document.querySelectorAll('.audio-play-btn.playing');
                    playButtons.forEach(btn => {
                        btn.classList.remove('playing');
                        btn.innerHTML = '<i class="fas fa-play"></i>';
                    });
                }
            }

            base64ToBlob(base64Data, contentType) {
                const byteCharacters = atob(base64Data);
                const byteNumbers = new Array(byteCharacters.length);
                
                for (let i = 0; i < byteCharacters.length; i++) {
                    byteNumbers[i] = byteCharacters.charCodeAt(i);
                }
                
                const byteArray = new Uint8Array(byteNumbers);
                return new Blob([byteArray], { type: contentType });
            }

            formatMessage(content) {
                // Enhanced message formatting with crypto-specific styling
                let formatted = content
                    // Format cryptocurrency symbols
                    .replace(/\$([A-Z]{2,5})/g, '<span class="crypto-symbol">$1</span>')
                    // Format price mentions
                    .replace(/\$([0-9,]+\.?[0-9]*)/g, '<span class="price-highlight">$1</span>')
                    // Format percentage changes
                    .replace(/([+-]?\d+\.?\d*)%/g, '<span class="percentage">$1%</span>')
                    // Format bold text
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    // Format code blocks
                    .replace(/`(.*?)`/g, '<code>$1</code>')
                    // Format line breaks
                    .replace(/\n/g, '<br>');

                return formatted;
            }

            showTypingIndicator() {
                const typingDiv = document.createElement('div');
                typingDiv.className = 'message ai-message typing-message';
                typingDiv.innerHTML = `
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content">
                        <div class="message-text">
                            <div class="typing-indicator">
                                <span>Kryptonic AI is thinking</span>
                                <div class="typing-dots">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                this.chatBox.appendChild(typingDiv);
                this.scrollToBottom();
            }

            removeTypingIndicator() {
                const typingMessage = this.chatBox.querySelector('.typing-message');
                if (typingMessage) {
                    typingMessage.remove();
                }
            }

            scrollToBottom() {
                setTimeout(() => {
                    this.chatBox.scrollTop = this.chatBox.scrollHeight;
                }, 100);
            }

            autoResizeInput() {
                this.messageInput.style.height = 'auto';
                this.messageInput.style.height = Math.min(this.messageInput.scrollHeight, 120) + 'px';
            }

            showToast(message, type = 'info') {
                const toast = document.createElement('div');
                toast.className = `toast toast-${type}`;
                toast.textContent = message;
                
                document.body.appendChild(toast);

                // Animate in
                setTimeout(() => {
                    toast.style.opacity = '1';
                    toast.style.transform = 'translateX(0)';
                }, 100);

                // Remove after 3 seconds
                setTimeout(() => {
                    toast.style.opacity = '0';
                    toast.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        if (document.body.contains(toast)) {
                            document.body.removeChild(toast);
                        }
                    }, 300);
                }, 3000);
            }

            displayWelcomeMessage() {
                setTimeout(() => {
                    this.scrollToBottom();
                }, 500);
            }

            initializeTheme() {
                // Load theme preference from localStorage or default to dark
                const savedTheme = localStorage.getItem('kryptonic-theme') || 'dark';
                this.setTheme(savedTheme);
            }

            setTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('kryptonic-theme', theme);
                this.updateThemeIcon(theme);
            }

            updateThemeIcon(theme) {
                const themeIcon = document.getElementById('theme-icon');
                if (themeIcon) {
                    if (theme === 'dark') {
                        themeIcon.className = 'fas fa-sun';
                    } else {
                        themeIcon.className = 'fas fa-moon';
                    }
                }
            }

            toggleTheme() {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                this.setTheme(newTheme);
                this.showToast(`Switched to ${newTheme} mode`, 'info');
                
                // Regenerate particles to match new theme
                setTimeout(() => {
                    initializeParticles();
                }, 100);
            }
        }

        // Global functions for quick actions and utilities
        async function sendQuickMessage(message) {
            const app = window.kryptonicApp;
            if (app) {
                // Add user message to chat
                app.addMessage(message, 'user');
                
                // Show typing indicator
                app.showTypingIndicator();
                
                // Send message to backend API
                try {
                    const response = await app.sendMessageToAPI(message);
                    app.removeTypingIndicator();
                    app.addMessage(response.text, 'ai', false, response.audio);
                } catch (error) {
                    console.error('Error generating response:', error);
                    app.removeTypingIndicator();
                    app.addMessage("I'm having trouble processing your request right now. Please try again in a moment.", 'ai', true);
                }

                // Scroll to bottom and focus input
                app.scrollToBottom();
                app.messageInput.focus();
            }
        }

        function clearChat() {
            const app = window.kryptonicApp;
            if (app && confirm('Are you sure you want to clear the chat history?')) {
                // Stop any playing audio
                app.stopCurrentAudio();
                
                const messages = app.chatBox.querySelectorAll('.message');
                messages.forEach((message, index) => {
                    if (index > 0) { // Keep the welcome message
                        setTimeout(() => {
                            message.style.opacity = '0';
                            message.style.transform = 'translateY(-20px)';
                            setTimeout(() => message.remove(), 300);
                        }, index * 50);
                    }
                });
                // Generate new session ID for fresh conversation
                app.sessionId = app.generateSessionId();
                app.showToast('Chat cleared! New session started.', 'info');
            }
        }

        function toggleVoiceOutput() {
            const app = window.kryptonicApp;
            if (app) {
                app.toggleVoiceOutput();
            }
        }

        function toggleVoiceInput() {
            const app = window.kryptonicApp;
            if (app) {
                app.toggleVoiceRecognition();
            }
        }

        function showMarketOverview() {
            sendQuickMessage('Show me the current market overview');
        }

        function showTrending() {
            sendQuickMessage('What are the trending cryptocurrencies?');
        }

        // Theme management functions
        function toggleTheme() {
            const app = window.kryptonicApp;
            if (app) {
                app.toggleTheme();
            }
        }

        function setTheme(theme) {
            const app = window.kryptonicApp;
            if (app) {
                app.setTheme(theme);
            }
        }

        // Load real market data from CoinGecko API
        async function loadMarketData() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=5&page=1&sparkline=false');
                const data = await response.json();
                const marketContainer = document.getElementById('market-data');
                
                if (data && data.length > 0) {
                    marketContainer.innerHTML = data.map((coin, index) => {
                        const price = coin.current_price ? `$${coin.current_price.toLocaleString()}` : 'N/A';
                        const change = coin.price_change_percentage_24h ? `${coin.price_change_percentage_24h.toFixed(2)}%` : '0%';
                        const isPositive = coin.price_change_percentage_24h >= 0;
                        
                        return `
                            <div class="market-item" style="animation-delay: ${index * 0.1}s" onclick="sendQuickMessage('Tell me more about ${coin.name}')">
                                <div class="coin-info">
                                    <span class="coin-name">${coin.name}</span>
                                    <span class="coin-symbol">${coin.symbol.toUpperCase()}</span>
                                </div>
                                <div class="coin-price">
                                    <span class="price">${price}</span>
                                    <span class="change ${isPositive ? 'positive' : 'negative'}">
                                        ${change}
                                    </span>
                                </div>
                            </div>
                        `;
                    }).join('');
                } else {
                    marketContainer.innerHTML = `
                        <div class="error-placeholder">
                            <i class="fas fa-exclamation-triangle"></i>
                            <p>Unable to load market data</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading market data:', error);
                const marketContainer = document.getElementById('market-data');
                marketContainer.innerHTML = `
                    <div class="error-placeholder">
                        <i class="fas fa-wifi"></i>
                        <p>Connection error</p>
                    </div>
                `;
            }
        }

        // Load real trending data from CoinGecko API
        async function loadTrendingData() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/search/trending');
                const data = await response.json();
                const trendingContainer = document.getElementById('trending-data');
                
                if (data && data.coins && data.coins.length > 0) {
                    trendingContainer.innerHTML = data.coins.slice(0, 5).map((coin, index) => `
                        <div class="trending-item" style="animation-delay: ${index * 0.1}s" onclick="sendQuickMessage('What is the price of ${coin.item.name}?')">
                            <span class="rank">${index + 1}</span>
                            <div class="coin-info">
                                <span class="coin-name">${coin.item.name}</span>
                                <span class="coin-symbol">${coin.item.symbol}</span>
                            </div>
                            <div class="trending-indicator">
                                <i class="fas fa-fire"></i>
                            </div>
                        </div>
                    `).join('');
                } else {
                    trendingContainer.innerHTML = `
                        <div class="error-placeholder">
                            <i class="fas fa-exclamation-triangle"></i>
                            <p>Unable to load trending data</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading trending data:', error);
                const trendingContainer = document.getElementById('trending-data');
                trendingContainer.innerHTML = `
                    <div class="error-placeholder">
                        <i class="fas fa-wifi"></i>
                        <p>Connection error</p>
                    </div>
                `;
            }
        }

        function initializeParticles() {
            const particles = document.querySelector('.background-particles');
            if (!particles) return;
            
            particles.innerHTML = '';
            const particleCount = window.innerWidth > 768 ? 50 : 25;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                
                const size = Math.random() * 3 + 1;
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';
                
                particles.appendChild(particle);
            }
        }

        // Initialize everything when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize main app
            window.kryptonicApp = new KryptonicAI();
            
            // Initialize UI components
            initializeParticles();
            loadMarketData();
            loadTrendingData();
            
            // Set up periodic data refresh
            setInterval(() => {
                loadMarketData();
                loadTrendingData();
            }, 30000);
            
            // Handle window resize for particles
            let resizeTimeout;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    initializeParticles();
                }, 250);
            });
            
            // Add keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if ((e.ctrlKey || e.metaKey) && e.key === '/') {
                    e.preventDefault();
                    document.getElementById('message-text').focus();
                }
                
                if (e.key === 'Escape') {
                    document.getElementById('message-text').value = '';
                    document.getElementById('message-text').blur();
                    // Stop any playing audio
                    if (window.kryptonicApp) {
                        window.kryptonicApp.stopCurrentAudio();
                    }
                }
                
                // Toggle voice output with Ctrl/Cmd + M
                if ((e.ctrlKey || e.metaKey) && e.key === 'm') {
                    e.preventDefault();
                    toggleVoiceOutput();
                }

                // Toggle theme with Ctrl/Cmd + T
                if ((e.ctrlKey || e.metaKey) && e.key === 't') {
                    e.preventDefault();
                    toggleTheme();
                }
            });
            
            console.log('Kryptonic AI initialized successfully with voice capabilities!');
        });
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</body>
</html>